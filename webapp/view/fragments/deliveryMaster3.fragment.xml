<core:FragmentDefinition xmlns="sap.m" 
    xmlns:core="sap.ui.core" 
    xmlns:f="sap.f" 
    xmlns:fb="sap.ui.comp.filterbar" 
    xmlns:ui="sap.ui.table" 
    xmlns:mvc="sap.ui.core.mvc"
    >

    
            <fb:FilterBar
            id="filterbar"
            persistencyKey="myPersKey"
            useToolbar="false"
            search=".onSearch"
            filterChange=".onFilterChange"
            afterVariantLoad=".onAfterVariantLoad"
            showGoOnFB="true"
            showFilterConfiguration="true"
            class="sapUiSmallMarginBottom"   
        >
            <fb:filterGroupItems>
                <fb:FilterGroupItem
                    name="Date Processamento EDI"
                    label="Date Processamento EDI"
                    groupName="Group1"
                    visibleInFilterBar="true"
                >
                    <fb:control>
                    <DatePicker
                    tooltip="..."
        secondaryCalendarType="Gregorian"
        change="handleChange"
        />
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem
                id="idDataConsegna"
                    name="Date di consegna"
                    label="Date di consegna"
                    groupName="Group1"
                    visibleInFilterBar="true"
                >
                    <fb:control>
                     <DatePicker
                      tooltip="..."
        secondaryCalendarType="Gregorian"
        change="handleChange"
        />
                    </fb:control>
                </fb:FilterGroupItem>
                <fb:FilterGroupItem
                    name="Cliente"
                    label="Cliente"
                    groupName="Group1"
                    visibleInFilterBar="true"
                >
                    <fb:control>
                       <Input/>
                    </fb:control>
                </fb:FilterGroupItem>
                 <fb:FilterGroupItem
                    name="Materiale"
                    label="Materiale"
                    groupName="Group1"
                    visibleInFilterBar="true"
                >
                    <fb:control>
                    <Input/>
                    </fb:control>
                </fb:FilterGroupItem>
                
                 <fb:FilterGroupItem
                    name="Stato"
                    label="Stato"
                    groupName="Group1"
                    visibleInFilterBar="true"
                >
                    <fb:control>
                        <ComboBox
                            name=""
                            selectionChange=".onSelectionChange"
                        >
                            <core:Item
                                key="{key}"
                                text="OK"
                            />
                            <core:Item
                                key="{key}"
                                text="KO"
                            />
                            <core:Item
                                key="{key}"
                                text="WARNING"
                            />
                        </ComboBox>
                    </fb:control>
                </fb:FilterGroupItem>
                
            </fb:filterGroupItems>
        </fb:FilterBar>
   
            
        <ui:TreeTable 
        id="treetableMain"
        rows="{path: 'master3>/Master3', parameters: {arrayNames: ['DelforPosizioni']}}"
        selectionMode="MultiToggle"
        enableSelectAll="false"
        ariaLabelledBy="title"
        >
        <!-- cellClick=".rowDetailPress" -->
    <ui:extension>
        <OverflowToolbar style="Clear">
            <Title  />
            <ToolbarSpacer/>
            <Button text="Collassa tutti" press="onCollapseAll"/>
            <Button text="Collassa selezione" press="onCollapseSelection"/>
            <Button text="Espandi primo livello" press="onExpandFirstLevel"/>
            <Button text="Espandi selezione" press="onExpandSelection"/>
            <Button
                icon="sap-icon://sort"
                text="Ordinamento"
                press="sortCategories"/>
                <Button
                icon="sap-icon://excel-attachment"
                text="Caricamento Manuale"
                press="importaPress"/>
                <Button
               
                text="Esporta Template Manuale"
                icon="sap-icon://excel-attachment"
                press="deletePress"/>
                <Button
               
                text="Elabora"
                icon="sap-icon://process"
                press="onProcessaButton"
                type="Emphasized"/>
              
                <Button
                
                text="Elimina"
                icon="sap-icon://delete"
                press=""
                type="Reject"/>
        </OverflowToolbar>
    </ui:extension>
    <ui:columns>
       
        <ui:Column tooltip="Cliente">
            <Label text="Cliente"/>
            <ui:template>
                <!-- <ObjectIdentifier
                        title="{master3>CompanyName}"
                    /> -->
                      <Text text="{master3>DelforTestata/template}"/>
            </ui:template>
        </ui:Column>
        <ui:Column tooltip="Numero progressivo invio">
            <Label text="Numero progressivo invio"/>
            <ui:template>
                <ObjectIdentifier
                        title="{master3>DelforTestata/numero_progressivo_invio}"
                    />
            </ui:template>
        </ui:Column>
        <ui:Column tooltip="Data ricezione">
            <Label text="Data ricezione" />
            <ui:template>
                 <ObjectIdentifier
                        title="{path:'master3>DelforTestata/data_ricezione', formatter: '.formatDate'}"
                        
                    />
            </ui:template>
        </ui:Column>
        <!-- posizioni -->
        <ui:Column tooltip="Codice materiale fornitore">
            <Label text="Codice materiale fornitore" />
            <ui:template>
             <ObjectIdentifier
                        title="{master3>codice_materiale_fornitore}"
                    />
            </ui:template>
        </ui:Column>
          <ui:Column tooltip="Numero ordine acquisto">
            <Label text="Numero ordine acquisto" />
            <ui:template>
             <ObjectIdentifier
                        title="{master3>numero_ordine_acquisto}"
                    />
            </ui:template>
        </ui:Column>
      
          <ui:Column tooltip="Numero idoc">
            <Label text="Numero idoc" />
            <ui:template>
             <ObjectIdentifier
                        title="{master3>numero_idoc}"
                    />
            </ui:template>
        </ui:Column>
        <ui:Column hAlign="Center" tooltip="Stato">
          <Label text="Stato"/>
          <ui:template>
              <Button icon="{= ${master3>Stato} === 'OK' ? 'sap-icon://accept' : ${master3>Stato} === 'KO' ? 'sap-icon://decline' : 'sap-icon://warning'}" 
                  type="{= ${master3>Stato} === 'OK' ? 'Accept' : ${master3>Stato} === 'KO' ? 'Negative' : 'Critical'}"
                  tooltip="{master3>Stato}" press="statoButtonPress"/>
              <!-- <Button text="{master3>template}"></Button> -->
               <!-- <Text text="X"/> -->
          </ui:template>
      </ui:Column>
          <ui:Column hAlign="Center" tooltip="">
            <Label text="" />
            <ui:template>
                <HBox>
                    <Button icon="sap-icon://display" type="Emphasized" press="dettaglioNav" tooltip="Dettaglio"></Button>
                    <Button text="navToApp" type="Unstyled" class="sapUiTinyMarginBegin" press="navToAPP"></Button>
                    
                </HBox>
             
            </ui:template>
          
        </ui:Column>
    </ui:columns>
</ui:TreeTable>
    
</core:FragmentDefinition>